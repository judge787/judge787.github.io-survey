<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="stylesheet.css">
    <script src="https://unpkg.com/read-excel-file@5.x/bundle/read-excel-file.min.js"></script>
    <title>Two-Container Page</title>
</head>
<body>
    <div class="container">
        <div class="left-container">
            <h1>AIR</h1>
            <h3 class="menu-link"><a href="index.html">Home</a></h3>
            <h3 class="menu-link"><a href="facilities.html">Facilities</a></h3>
            <h3 class="menu-link"><a href="publications.html">Publications</a></h3>
            <h3 class="menu-link"><a href="survey.html"><u>Survey</u></a></h3>
            <h3 class="menu-link"><a href="teaching.html">Teaching</a></h3>
            <h3 class="menu-link"><a href="links.html">Links</a></h3>
            <h3 class="menu-link"><a href="group.html">Group</a></h3>
            <h3 class="menu-link"><a href="positions.html">Positions</a></h3>
            <h3 class="menu-link"><a href="funding.html">Funding</a></h3>
            <h3 class="menu-link"><a href="sponsors.html">Sponsors</a></h3>
            <h3 class="menu-link"><a href="news.html">News</a></h3>
            <h3 class="menu-link"><a href="contact.html">Contact</a></h3>
            <!-- Content of the left container -->
        </div>
        <div class="right-container">
            <h1>Atmospheric Research Innovations Lab </h1>
        <h3>Residential Home Energy Consumption Survey</h3>

        <p> 
            Did you know that buildings are responsible for 40% of global energy use?<br>
        <br>
        <img src="../Figures/OppositeHouseNarrow.jpg" width= 100%;/>
        <br>  
        <p>Figure 1: Opposite House, designed by Atelier RZLBD, Toronto, Canada</p>
        <br> 
        In an effort to combat climate change, this survey attempts to collect data for academic research on
        building energy consumption in Canada and the United States. Data will be used to understand build-
        ing performance, develop prediction and design models, and lead innovation to reduce building energy
        consumption. By participation in this survey, your privacy will be protected. To protect individuals
        data, information will be collected as anonymous and only reported in aggregate form, i.e. by combining
        large sets of data. This study is organized by Amir A. from Environmental Engineering at the
        University of Guelph. Please complete this form and email it to aliabadi@uoguelph.ca. To access the
        form visit:
        </p>
        <br><br>
        <img src="../figures/AIR Logo Text.jpg" width="200"/>
        <br><br><br>

        <!-- start the survey here -->
        <div class="grey-container">
          <form onsubmit="event.preventDefault(); printUserInputs();">

          <h3>1. Basic Information About Your Residential Homes</h3> <br><br>
          <br>
          <div class="adjust-size">
          <label for="q1" >Q1. Your postal code (Example: N1G 1X9 or 02119): </label>
          <input type="text" id="q1" name="q1">
          </div>
          <div class="adjust-size">
            <label for="q2">Q2. Type of your residential home:</label>
            <select id="q2" name="q2">
              <option value="single-detached-house">Single-detached house</option>
              <option value="semi-detached-house">Semi-detached house</option>
              <option value="row-house">Row house</option>
              <option value="apartment-less-than-5">Apartment in a building with less than 5 storeys</option>
              <option value="apartment-more-than-5">Apartment in a building with more than 5 storeys</option>
              <option value="other">Other</option>
            </select>
          </div>
          
          <div class="adjust-size none" id="q2other">
            <label for="q2other-input">Other:</label>
            <input type="text" id="q2other-input" name="q2other">
          </div>
          
          <div class="adjust-size">
            <label for="q3">Q3. Number of people living in your home:</label>
            <select id="q3" name="q3">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
            </select>
          </div>


          <div class="adjust-size">
            <label for="q4" >Q4. What is the approximate footprint area of your residential home? For multi-storey buildings, the footprint area is only associated with one storey of the building; please exclude garages, yards, and other spaces that are not heated or cooled:</label>
            <select id="q4" name="q4">
              <option value="tiny">Tiny: about 50 m&sup2; or 500 ft&sup2;</option>
              <option value="small">Small: about 100 m&sup2; or 1000 ft&sup2;</option>
              <option value="medium">Medium: about 200 m&sup2; or 2000 ft&sup2;</option>
              <option value="large">Large: about 300 m&sup2; or 3000 ft&sup2;</option>
              <option value="supersize">Supersize: about 400 m&sup2; or 4000 ft&sup2;</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="adjust-size none" id="q4other">
            <label for="q4other-input">Other:</label>
            <input type="text" id="q4other-input" name="q4other">
          </div>


          <div class="adjust-size wrap">
            <label for="q5">Q5. How many storeys in your residential home are heated and/or cooled?</label>
            <select id="q5" name="q5">
              <option value="1">1 (flat apartment or bungalow house with possibly a basement)</option>
              <option value="2">2 (back-split apartment or house with possibly a basement)</option>
              <option value="3">3 (two-level apartment or house with possibly a basement)</option>
              <option value="4">4 (three-level apartment or house with possibly a basement)</option>
              <option value="5">5 (four-level apartment or house with possibly a basement)</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="adjust-size none" id="q5other">
            <label for="q5other-input">Other:</label>
            <input type="text" id="q5other-input" name="q5other">
          </div>

          
          <div class="adjust-size wrap">
            <label for="q6">Q6. Type of space heating system:</label>
            <select id="q6" name="q6">
              <option value="natural-gas-furnace">Natural gas furnace (most common)</option>
              <option value="heat-pump">Heat pump powered by electricity (used in moderate climates)</option>
              <option value="electric-baseboard">Baseboard powered by electricity or electric heaters</option>
              <option value="no-system">I don't have a space heating system</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="adjust-size none" id="q6other">
            <label for="q6other-input">Other:</label>
            <input type="text" id="q6other-input" name="q6other">
          </div>
          

          <div class="adjust-size wrap">
            <label for="q7">Q7. Type of space cooling system:</label>
            <select id="q7" name="q7">
              <option value="air-conditioning">Air conditioning: vapor compression (most common)</option>
              <option value="evaporative-cooling">Evaporative cooling system (used in dry climates)</option>
              <option value="no-system">I don't have a space cooling system</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="adjust-size none" id="q7other">
            <label for="q7other-input">Other:</label>
            <input type="text" id="q7other-input" name="q7other">
          </div>
          

          <div class="adjust-size">
            <label for="q8">Q8. Type of water heating system:</label>
            <select id="q8" name="q8">
              <option value="natural-gas-water-heater">Natural gas water heater (most common)</option>
              <option value="electric-water-heater">Electric water heater (less common)</option>
              <option value="no-system">I don't have a water heating system</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="adjust-size none" id="q8other">
            <label for="q8other-input">Other:</label>
            <input type="text" id="q8other-input" name="q8other">
          </div>
          
          
          <div class="adjust-size wrap">
            <label for="q9">Q9. Type of stove/oven system:</label>
            <select id="q9" name="q9">
              <option value="natural-gas">Natural gas</option>
              <option value="electric">Electric</option>
              <option value="both">Both natural gas and electric</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="adjust-size none" id="q9other">
            <label for="q9other-input">Other:</label>
            <input type="text" id="q9other-input" name="q9other">
          </div>
          

          <div class="adjust-size">
            <label>Q10. Which one of the uncommon devices below depend on substantial amount of energy in your home (choose as many as may apply)?</label>
          </div>
          <div>
            <label for="q10a"><input type="checkbox" id="q10a" name="uncommon-device" value="electric-car">Electric car charged by electricity</label>
            <br>
            <label for="q10b"> <input type="checkbox" id="q10b" name="uncommon-device" value="fire-place">Fire place powered by natural gas</label>
            <br>
            <label for="q10c"><input type="checkbox" id="q10c" name="uncommon-device" value="swimming-pool">Swimming pool, sauna, etc.</label>
            <br>
            <label for="q10d"> <input type="checkbox" id="q10d" name="uncommon-device" value="no-uncommon-devices">No uncommon devices</label>
          </div>        
      
          <div class="adjust-size"> 
            <label for="q10e">Other:</label>
            <input type="text" id="q10e" name="other-uncommon-devices">
          </div>

          <div class="adjust-size">
            <label for="year-built">Q11. Approximately when was your residential home built?</label>
            <select id="q11" name="year-built">
              <option value="before-1950s">Before 1950s</option>
              <option value="between-1950s-and-2000s">Between 1950s and 2000s</option>
              <option value="after-2000s">After 2000s</option>
              <option value="unknown">I don't know</option>
            </select>
          </div>

          <div class="adjust-size">
            <label for="energy-retrofit">Q12. When was your residential home retrofitted for energy efficiency?</label>
            <select id="q12" name="energy-retrofit">
              <option value="before-1950s">Before 1950s</option>
              <option value="between-1950s-and-2000s">Between 1950s and 2000s</option>
              <option value="after-2000s">After 2000s</option>
              <option value="never">Never</option>
              <option value="dont-know">I don't know</option>
            </select>
          </div>

          <div class = "adjust-size">
            <p>Q13. If your home has been retrofitted for energy efficiency, click on all the features that apply to your
              home. Describe any specifics of the system components (e.g. the size of your photovoltaic panels, etc.)?</p>
          </div>

          <div id="checkbox-input-container"></div>

          <!-- starting redo for q13, the automation gave me way too many problems -->

          
            <label for = "q13a1"> <input type = "checkbox" id = "q13a1" name = "q13a1" value = "air-leak">My home was air-leak was tested and now it is leak-proof</label>

          <div class="adjust-size none" id="q13a2">
            <label for="q13a2">Specifics:</label>
            <input type="text" id="q13a2-input" name="q13a2-input">
          </div>  
            <div class="adjust-size">
            <label for = "q13b1">  <input type = "checkbox" id = "q13b1" name = "q13b1" value = "energy-efficient windows">I replaced my windows with energy efficient windows (e.g. double or tripple-layer)</label>
          </div>
      
          
          <div class="adjust-size none" id="q13b2">
            <label for="q13b2">Specifics:</label>
            <input type="text" id="q13b2-input" name="q13b2-input">
          </div> 
          
          <div class = "adjust-size">
            <label for = "q13c1"><input type = "checkbox" id = "q13c1" name = "q13c1" value = "high-efficiency furnace">I installed a high efficiency furnace</label>
          </div>
          
          <div class="adjust-size none" id="q13c2">
            <label for="q13c2">Specifics:</label>
            <input type="text" id="q13c2-input" name="q13c2-input">
          </div>
          
          <div class = "adjust-size">
            <label for = "q13d1"><input type = "checkbox" id = "q13d1" name = "q13d1" value = "increase R -value">I increased the thermal insulation of my building envelop (e.g. increase R-value, foam spray under
              roof, etc.)r</label>
          </div>
          
          <div class="adjust-size none" id="q13d2">
            <label for="q13d2">Specifics:</label>
            <input type="text" id="q13d2-input" name="q13d2-input">
          </div>
          
          <div class = "adjust-size">
            <label for = "q13e1"><input type = "checkbox" id = "q13e1" name = "q13e1" value = "photovoltaic system">I installed a photovoltaic system</label>
          </div>
          
          <div class="adjust-size none" id="q13e2">
            <label for="q13e2">Specifics:</label>
            <input type="text" id="q13e2-input" name="q13e2-input">
          </div> 
        
          <div class = "adjust-size">
          <label for = "q13f1"> <input type = "checkbox" id = "q13f1" name = "q13f1" value = "heat pump">I installed a heat pump for home heating</label>
          </div>

          <div class="adjust-size none" id="q13f2">
            <label for="q13f2">Specifics:</label>
            <input type="text" id="q13f2-input" name="q13f2-input">
          </div>

          <div class = "adjust-size">
            <label for = "q13g1"><input type = "checkbox" id = "q13g1" name = "q13g1" value = "solar thermal collector">I installed a solar thermal collector</label>
          </div>

          <div class="adjust-size none" id="q13g2">
            <label for="q13g2">Specifics:</label>
            <input type="text" id="q13g2-input" name="q13g2-input">
          </div>

          <div class = "adjust-size">
            <label for = "q13h1"><input type = "checkbox" id = "q13h1" name = "q13h1" value = "thermal energy storage system">I installed a thermal energy storage system</label>
          </div>

          <div class="adjust-size none" id="q13h2">
            <label for="q13h2">Specifics:</label>
            <input type="text" id="q13h2-input" name="q13h2-input">
          </div>

          <div class = "adjust-size">
            <label for = "q13i1"> <input type = "checkbox" id = "q13i1" name = "q13i1" value = "green roof">I have installed a green roof</label>
          </div>

          <div class="adjust-size none" id="q13i2">
            <label for="q13i2">Specifics:</label>
            <input type="text" id="q13i2-input" name="q13i2-input">
          </div>

          <div class = "adjust-size">
            <label for = "q13j1"><input type = "checkbox" id = "q13j1" name = "q13j1" value = "other systems">I have installed other systems not described above</label>
          </div>

          <div class="adjust-size none" id="q13j2">
            <label for="q13j2">Specifics:</label>
            <input type="text" id="q13j2-input" name="q13j2-input">
          </div>
          
          <h3>2. Natural Gas or Other Fuel Consumption Data</h3>
          
          <input type="file" id="excelFile" accept=".xls,.xlsx"/>

          <p>OR fill in the table below of your bills for the past 12 months to indicate your natural gas (or other fuel) consumption. Note: the entries below can be populated by referring to your natural gas (or other fuel) bills (e.g. Figure 2 below). Please fill up to 12 entries. It is recommended to consider bills for at least 1 full year of natural gas (of other fuel) consumption. Your bills should come from the utility company in your region, such as Enbridge. If you have consumption data for less than 1 full year, that is still fine.</p>
          <img src="../figures/EnbridgeBill.png" width="500"/>
          <p>Figure 2: Sample natural gas bill with billing period (May 10, 2021 - Jun 10, 2021) and consumption (100.17 m3) boxed in red</p>
          <br>
          <p>Q14. Provide Information on up to 12 bills: consumption in cubic meters m^3</p> <br>

          <div id="question14"></div>

          
          <h3>3. Electricity Consumption Data</h3>

          <input type="file" id="excelFile2" accept=".xls,.xlsx"/>

          <p>fill the table below to indicate my electricity consumption. Note: the entries below can be populated by referring to your electricity bills (e.g. Figure 3 below). Please fill up to 12 entries. It is recommended to consider bills for at least 1 full year of electricity consumption. Your bills should come from the utility company in your region, such as Toronto Hydro. If you have consumption data for less than 1 full year, that is still fine.</p> <br>
          <!-- !important, im not sure if i want to add any of the figures, we might just replace it with a short video instead at the end of the page -->
          <p>Q15. Provide Information on up to 12 bills: consumption in kilo Watt hours (kW-hr); please note that in some regions the electricity price varies according to time of year and day. In such cases, simply report the total electricity used in the billing cycle by adding all the consumptions together.</p><br>

          <div id="question15"></div>
          
          <h3>4. Other Information</h3>
        
          <div>
            <label for="q16">Q16. Please provide any other information that you think may help this survey. Please do not disclose any personal, private, or identifying information about yourself.</label>
            <input type="text" id="q16" name="q16">
          </div>
          
          
          <div class="adjust-size">
            <input type="checkbox" id="consent" required>
            <label for="consent">I accept the <a href ="#consent">terms and conditions</a></label>
            <button type="submit" id="button">Submit</button>
            
          </div>

          <!-- <script>const consentCheckbox = document.getElementById('consent');
            const submitButton = document.getElementById('button');
            
            submitButton.addEventListener('click', (event) => {
              if (!consentCheckbox.checked) {
                event.preventDefault();
                consentCheckbox.style.border = '2px solid red';
                alert('Please accept the terms and conditions before submitting the form.');
              }
            });</script> -->
          </form>
        </div>
        <br>

        <div class="grey-container">
          <h3 id="consent">5. Participant Consent Form</h3>
          <p>Title of the Study: Residential Home Energy Consumption Survey 
            <br><br>Researcher: Professor Amir A. Aliabadi, School of Engineering, University of Guelph, RICH 2515, University of Guelph, Guelph, ON, Canada, N1G 2W1, 519-824-4120 x.54862, <a href="mailto:aliabadi@uoguelph.ca" id="email">aliabadi@uoguelph.ca</a> 
            <br><br>Introduction: You are being invited to participate in a research project that aims to collect information about your residential home fuel (e.g. natural gas) and electricity consumption. Before you decide whether to participate, it is important that you understand why the study is being conducted, what participation involves, and what risks and benefits are associated with participation. Please take the time to read this consent form carefully and ask any questions you may have before making your decision. Purpose: The purpose of this study is to collect information about your residential home fuel (e.g. natural gas) and electricity consumption patterns in order to gain a better understanding of how these resources are used in Canada. Data will be used to understand building performance, develop prediction and design models, and lead innovation to reduce building energy consumption.
            <br><br>Inclusion and Exclusion Criteria: To be eligible to participate, you must be A home owner or be able to provide information about a home.
            <br><br>Nature of Participation: If you decide to participate, you will be asked to provide information about your fuel (e.g. natural gas) and electricity consumption patterns over a period of up to one year through an online survey. You will also have the option to participate in a follow-up survey at a later date to submit more energy consumption data. Participation is voluntary and you are free to withdraw at anytime without penalty.
            <br><br>Duration of Participation: Your participation in this study is expected to last for approximately 20 minutes if completed correctly. You will be asked to complete the online survey once, and may be invited to participate in a follow-up survey in the future.
            <br><br>Procedures: You will be asked to complete an online survey that will take approximately 20 minutes to complete. The survey will include questions about your fuel (e.g. natural gas) and electricity consumption bills and your home general features. Your responses will be kept confidential and will only be used for research purposes.
            <br><br>Responsibilities of the Participant: As a participant in this study, your responsibilities include providing accurate information about your residential home fuel (e.g. natural gas) and electricity consumption bills, and completing the online survey to the best of your ability.
            <br><br>Risks: There are no anticipated risks associated with participation in this study. Even though energy consumption data is provided, your participation is anonymous, so you cannot be identified.
            <br><br>Benefits: Once we finish our analysis of building energy data, participants can compare their energy consumption with average statistics. This can give them incentive to save extra energy for their buildings. Climate change is the greatest existential threat to humans. 40% of world energy consumption is by buildings, and thus 40% of greenhouse gas emissions are caused by buildings. Understanding building energy consumption and ways to mitigate harmful environmental impact is of paramount priority.
            <br><br>Obligation to Participate: You are under no obligation to participate in this study.
            <br><br>Withdrawal: You are free to withdraw from the survey prior to submitting the data at any time without prejudice to pre-existing entitlements.
            <br><br>Data Withdrawal: You are free to withdraw your data from the study prior to the data analysis and publication of the results without prejudice to pre-existing entitlements. If you choose to withdraw, your data will be destroyed permanently and will not be used in the study. If you have submitted your data but wish to withdraw it prior to data analysis and publication of the results, please provide your postal code to the researcher, so your data can be deleted and removed from the analysis.
            <br><br>Commercialization: There is no commercial interest in the study.
            <br><br>Conflicts of Interest: There are no real, potential, or perceived conflicts of interest on the part of the researchers, their institutions or the research sponsors.
            <br><br>Dissemination of Results: The results of this study will be disseminated through research papers, pre- sentations, posters, reports, etc. based on the data collected. Participants will not be identified directly or indirectly in any reports or publications.
            <br><br>Qualified Designated Representative: If you have any questions about the scientific or scholarly aspects of the research, you may contact Amir A. Aliabadi.
            <br><br>Ethical Issues: If you have any ethical concerns about the study, you may <a href= "contact.html" >contact Amir A. Aliabadi.</a> If you have any questions regarding your rights and welfare as a research participant in this survey.</p>
        </div>
    </div>
    <script>
        function generateContentQ14() {
          const container = document.getElementById("question14");
          let content = "";
    
          for (let i = 1; i <= 12; i++) {
            const letter = String.fromCharCode(96 + i); // Convert i to alphabet (a, b, c, ...)
            content += `
            <div class="adjust-size consumption billing">
              <label for="q14${letter}1">Bill ${i}: Start YYYY</label>
              <input type="text" id="q14${letter}1" name="q14${letter}1">
              <label for="q14${letter}2">MM</label>
              <input type="text" id="q14${letter}2" name="q14${letter}2">
              <label for="q14${letter}3">DD</label>
              <input type="text" id="q14${letter}3" name="q14${letter}3">
              <label for="q14${letter}4">End YYYY</label>
              <input type="text" id="q14${letter}4" name="q14${letter}4">
              <label for="q14${letter}5">MM</label>
              <input type="text" id="q14${letter}5" name="q14${letter}5">
              <label for="q14${letter}6">DD</label>
              <input type="text" id="q14${letter}6" name="q14${letter}6">
              <label for="q14${letter}7">Consumption m^3</label>
              <input type="text" id="q14${letter}7" name="q14${letter}7">
            </div>`;
          }
    
          container.innerHTML = content;
        }
    
        function generateContentQ15() {
          const container = document.getElementById("question15");
          let content = "";
    
          for (let i = 1; i <= 12; i++) {
            const letter = String.fromCharCode(96 + i); // Convert i to alphabet (a, b, c, ...)
            content += `
            <div class="adjust-size consumption billing">
              <label for="q15${letter}1">Bill ${i}: Start YYYY</label>
              <input type="text" id="q15${letter}1" name="q15${letter}1">
              <label for="q15${letter}2">MM</label>
              <input type="text" id="q15${letter}2" name="q15${letter}2">
              <label for="q15${letter}3">DD</label>
              <input type="text" id="q15${letter}3" name="q15${letter}3">
              <label for="q15${letter}4">End YYYY</label>
              <input type="text" id="q15${letter}4" name="q15${letter}4">
              <label for="q15${letter}5">MM</label>
              <input type="text" id="q15${letter}5" name="q15${letter}5">
              <label for="q15${letter}6">DD</label>
              <input type="text" id="q15${letter}6" name="q15${letter}6">
              <label for="q15${letter}7">Consumption m^3</label>
              <input type="text" id="q15${letter}7" name="q15${letter}7">
            </div>`;
          }
    
          container.innerHTML = content;
        }
        document.addEventListener("DOMContentLoaded", generateContentQ14);
        document.addEventListener("DOMContentLoaded", generateContentQ15);



        // js file code below

        // Read all excel cells and assign them to input ids


            function readExcelAndAutofill(event) {
            var fileInput = event.target;
            var file = fileInput.files[0];
            var reader = new FileReader();
            reader.onload = function (e) {
                var data = new Uint8Array(e.target.result);
                var workbook = XLSX.read(data, { type: "array" });
                var worksheet = workbook.Sheets[workbook.SheetNames[0]]; // Choose first workbook sheet in excel
                
                // If else statements to figure out which bill your working with
                if (worksheet.A1 ? worksheet.A1.v : "" == "Account Number") { // Enbridge Bill
                var cellData = {
                    q14a1: extractYear(worksheet.E2.v),
                    q14a2: extractMonth(worksheet.E2.v),
                    q14a3: extractDay(worksheet.E2.v),
                    q14a4: extractYear(worksheet.F2.v),
                    q14a5: extractMonth(worksheet.F2.v),
                    q14a6: extractDay(worksheet.F2.v),
                    q14a7: worksheet.J2.v,
                    
                    q14b1: extractYear(worksheet.E3.v),
                    q14b2: extractMonth(worksheet.E3.v),
                    q14b3: extractDay(worksheet.E3.v),
                    q14b4: extractYear(worksheet.F3.v),
                    q14b5: extractMonth(worksheet.F3.v),
                    q14b6: extractDay(worksheet.F3.v),
                    q14b7: worksheet.J3.v, 
            
                    q14c1: extractYear(worksheet.E4.v),
                    q14c2: extractMonth(worksheet.E4.v),
                    q14c3: extractDay(worksheet.E4.v),
                    q14c4: extractYear(worksheet.F4.v),
                    q14c5: extractMonth(worksheet.F4.v),
                    q14c6: extractDay(worksheet.F4.v),
                    q14c7: worksheet.J4.v, 
            
                    q14d1: extractYear(worksheet.E5.v),
                    q14d2: extractMonth(worksheet.E5.v),
                    q14d3: extractDay(worksheet.E5.v),
                    q14d4: extractYear(worksheet.F5.v),
                    q14d5: extractMonth(worksheet.F5.v),
                    q14d6: extractDay(worksheet.F5.v),
                    q14d7: worksheet.J5.v,

                    q14e1: extractYear(worksheet.E6.v),
                    q14e2: extractMonth(worksheet.E6.v),
                    q14e3: extractDay(worksheet.E6.v),
                    q14e4: extractYear(worksheet.F6.v),
                    q14e5: extractMonth(worksheet.F6.v),
                    q14e6: extractDay(worksheet.F6.v),
                    q14e7: worksheet.J6.v,  

                    q14f1: extractYear(worksheet.E7.v),
                    q14f2: extractMonth(worksheet.E7.v),
                    q14f3: extractDay(worksheet.E7.v),
                    q14f4: extractYear(worksheet.F7.v),
                    q14f5: extractMonth(worksheet.F7.v),
                    q14f6: extractDay(worksheet.F7.v),
                    q14f7: worksheet.J7.v,  

                    q14g1: extractYear(worksheet.E8.v),
                    q14g2: extractMonth(worksheet.E8.v),
                    q14g3: extractDay(worksheet.E8.v),
                    q14g4: extractYear(worksheet.F8.v),
                    q14g5: extractMonth(worksheet.F8.v),
                    q14g6: extractDay(worksheet.F8.v),
                    q14g7: worksheet.J8.v, 

                    q14h1: extractYear(worksheet.E9.v),
                    q14h2: extractMonth(worksheet.E9.v),
                    q14h3: extractDay(worksheet.E9.v),
                    q14h4: extractYear(worksheet.F9.v),
                    q14h5: extractMonth(worksheet.F9.v),
                    q14h6: extractDay(worksheet.F9.v),
                    q14h7: worksheet.J9.v,  

                    q14i1: extractYear(worksheet.E10.v),
                    q14i2: extractMonth(worksheet.E10.v),
                    q14i3: extractDay(worksheet.E10.v),
                    q14i4: extractYear(worksheet.F10.v),
                    q14i5: extractMonth(worksheet.F10.v),
                    q14i6: extractDay(worksheet.F10.v),
                    q14i7: worksheet.J10.v, 

                    q14j1: extractYear(worksheet.E11.v),
                    q14j2: extractMonth(worksheet.E11.v),
                    q14j3: extractDay(worksheet.E11.v),
                    q14j4: extractYear(worksheet.F11.v),
                    q14j5: extractMonth(worksheet.F11.v),
                    q14j6: extractDay(worksheet.F11.v),
                    q14j7: worksheet.J11.v,  

                    q14k1: extractYear(worksheet.E12.v),
                    q14k2: extractMonth(worksheet.E12.v),
                    q14k3: extractDay(worksheet.E12.v),
                    q14k4: extractYear(worksheet.F12.v),
                    q14k5: extractMonth(worksheet.F12.v),
                    q14k6: extractDay(worksheet.F12.v),
                    q14k7: worksheet.J12.v
                };
                } else if (worksheet.A7 ? worksheet.A7.v : "" == "Month") { // Hydro One Bill
                
                var cellData = {
                    q15a1: extractYear(worksheet.A8.v),
                    q15a2: extractMonth(worksheet.A8.v),
                    q15a3: "1",
                    q15a4: extractYear(worksheet.A8.v),
                    q15a5: extractMonth(worksheet.A8.v),
                    q15a6: extractDay(extractMonth(worksheet.A8.v).toString()),
                    q15a7: worksheet.B8.v,

                    q15b1: extractYear(worksheet.A9.v),
                    q15b2: extractMonth(worksheet.A9.v),
                    q15b3: "1",
                    q15b4: extractYear(worksheet.A9.v),
                    q15b5: extractMonth(worksheet.A9.v),
                    q15b6: extractDay(extractMonth(worksheet.A9.v).toString()),
                    q15b7: worksheet.B9.v,

                    q15c1: extractYear(worksheet.A10.v),
                    q15c2: extractMonth(worksheet.A10.v),
                    q15c3: "1",
                    q15c4: extractYear(worksheet.A10.v),
                    q15c5: extractMonth(worksheet.A10.v),
                    q15c6: extractDay(extractMonth(worksheet.A10.v).toString()),
                    q15c7: worksheet.B10.v,

                    q15d1: extractYear(worksheet.A11.v),
                    q15d2: extractMonth(worksheet.A11.v),
                    q15d3: "1",
                    q15d4: extractYear(worksheet.A11.v),
                    q15d5: extractMonth(worksheet.A11.v),
                    q15d6: extractDay(extractMonth(worksheet.A11.v).toString()),
                    q15d7: worksheet.B11.v,
                    
                    q15e1: extractYear(worksheet.A12.v),
                    q15e2: extractMonth(worksheet.A12.v),
                    q15e3: "1",
                    q15e4: extractYear(worksheet.A12.v),
                    q15e5: extractMonth(worksheet.A12.v),
                    q15e6: extractDay(extractMonth(worksheet.A12.v).toString()),
                    q15e7: worksheet.B12.v,

                    q15f1: extractYear(worksheet.A13.v),
                    q15f2: extractMonth(worksheet.A13.v),
                    q15f3: "1",
                    q15f4: extractYear(worksheet.A13.v),
                    q15f5: extractMonth(worksheet.A13.v),
                    q15f6: extractDay(extractMonth(worksheet.A13.v).toString()),
                    q15f7: worksheet.B13.v,

                    q15g1: extractYear(worksheet.A14.v),
                    q15g2: extractMonth(worksheet.A14.v),
                    q15g3: "1",
                    q15g4: extractYear(worksheet.A14.v),
                    q15g5: extractMonth(worksheet.A14.v),
                    q15g6: extractDay(extractMonth(worksheet.A14.v).toString()),
                    q15g7: worksheet.B14.v,
                    
                    q15h1: extractYear(worksheet.A15.v),
                    q15h2: extractMonth(worksheet.A15.v),
                    q15h3: "1",
                    q15h4: extractYear(worksheet.A15.v),
                    q15h5: extractMonth(worksheet.A15.v),
                    q15h6: extractDay(extractMonth(worksheet.A15.v).toString()),
                    q15h7: worksheet.B15.v,

                    q15i1: extractYear(worksheet.A16.v),
                    q15i2: extractMonth(worksheet.A16.v),
                    q15i3: "1",
                    q15i4: extractYear(worksheet.A16.v),
                    q15i5: extractMonth(worksheet.A16.v),
                    q15i6: extractDay(extractMonth(worksheet.A16.v).toString()),
                    q15i7: worksheet.B16.v,

                    q15j1: extractYear(worksheet.A17.v),
                    q15j2: extractMonth(worksheet.A17.v),
                    q15j3: "1",
                    q15j4: extractYear(worksheet.A17.v),
                    q15j5: extractMonth(worksheet.A17.v),
                    q15j6: extractDay(extractMonth(worksheet.A17.v).toString()),
                    q15j7: worksheet.B17.v,

                    q15k1: extractYear(worksheet.A18.v),
                    q15k2: extractMonth(worksheet.A18.v),
                    q15k3: "1",
                    q15k4: extractYear(worksheet.A18.v),
                    q15k5: extractMonth(worksheet.A18.v),
                    q15k6: extractDay(extractMonth(worksheet.A18.v).toString()),
                    q15k7: worksheet.B18.v,
                    
                    q15l1: extractYear(worksheet.A19.v),
                    q15l2: extractMonth(worksheet.A19.v),
                    q15l3: "1",
                    q15l4: extractYear(worksheet.A19.v),
                    q15l5: extractMonth(worksheet.A19.v),
                    q15l6: extractDay(extractMonth(worksheet.A19.v).toString()),
                    q15l7: worksheet.B19.v
                };
                } // Add other else if statements if want to be accessible for other bill types


                autofillInputs(cellData);
            };
            reader.readAsArrayBuffer(file);
            }

            // Extract the day from dates
            function extractDay(dateValue) {
            if (typeof dateValue === "string") {
                if (dateValue === "01" || dateValue === "03" || 
                    dateValue === "05" || dateValue === "07" || 
                    dateValue === "08" || dateValue === "10" || 
                    dateValue === "12") { 
                    return "31"; // For months with 31 days
                } else if (dateValue === "04" || dateValue === "06" || 
                        dateValue === "09" || dateValue === "11") {
                    return "30"; // For months with 30 days
                } else {
                    return "28"; // for February
                }
            } else {
                var dateObj = new Date((dateValue) * 24 * 60 * 60 * 1000);
                return dateObj.getDate();
            }
            }

            // Extract the month from dates
            function extractMonth(dateValue) {
            if (typeof dateValue === "string") {
                return dateValue.substr(0, 2);
            } else {
                var dateObj = new Date((dateValue - 1) * 24 * 60 * 60 * 1000); // Subtract 1 day to account for Excel's date origin
                var month = dateObj.getMonth() + 1; // Adding 1 as month index is zero-based
                return month;
            }
            }

            // Extract the year from dates
            function extractYear(dateValue) {
            if (typeof dateValue === "string") {
                return dateValue.substr(3, 7);
            } else {
                var dateObj = new Date((dateValue - 1) * 24 * 60 * 60 * 1000); // Subtract 1 day to account for Excel's date origin
                return dateObj.getFullYear() - 70; // Subtract 70 for correct date;
            }
            }

            // Autofill input fields in HTML by iteration
            function autofillInputs(cellData) {
            for (var key in cellData) {
                var input = document.getElementById(key);
                if (input) {
                input.value = cellData[key];
                }
            }
            }

            // Bind the readExcelAndAutofill function to file input change event

            let q13a2Value;
            let q13b2Value;
            let q13c2Value;
            let q13d2Value;
            let q13e2Value;
            let q13f2Value;
            let q13g2Value;
            let q13h2Value; 
            let q13i2Value;
            let q13j2Value;

            document.addEventListener('DOMContentLoaded', function () {
            //excel part
            document.getElementById("excelFile").addEventListener("change", readExcelAndAutofill, false);
            document.getElementById("excelFile2").addEventListener("change", readExcelAndAutofill, false);

            //shows/hides the specific input fields depending on the checkbox
            q13a1.addEventListener('change', function () {
                if (q13a1.checked) {
                q13a2.style.display = 'block';
                } else {
                q13a2.style.display = 'none';
                }
            });

            q13b1.addEventListener('change', function () {
                if (q13b1.checked) {
                q13b2.style.display = 'block';
                } else {
                q13b2.style.display = 'none';
                }
            });

            q13c1.addEventListener('change', function () {
                if (q13c1.checked) {
                q13c2.style.display = 'block';
                } else {
                q13c2.style.display = 'none';
                }
            });

            q13d1.addEventListener('change', function () {
                if (q13d1.checked) {
                q13d2.style.display = 'block';
                } else {
                q13d2.style.display = 'none';
                }
            });

            q13e1.addEventListener('change', function () {
                if (q13e1.checked) {
                q13e2.style.display = 'block';
                } else {
                q13e2.style.display = 'none';
                }
            });

            q13f1.addEventListener('change', function () {
                if (q13f1.checked) {
                q13f2.style.display = 'block';
                } else {
                q13f2.style.display = 'none';
                }
            });

            q13g1.addEventListener('change', function () {
                if (q13g1.checked) {
                q13g2.style.display = 'block';
                } else {
                q13g2.style.display = 'none';
                }
            });
            
            q13h1.addEventListener('change', function () {
                if (q13h1.checked) {
                q13h2.style.display = 'block';
                } else {
                q13h2.style.display = 'none';
                }
            });

            q13i1.addEventListener('change', function () {
                if (q13i1.checked) {
                q13i2.style.display = 'block';
                } else {
                q13i2.style.display = 'none';
                }
            });

            q13j1.addEventListener('change', function () {
                if (q13j1.checked) {
                q13j2.style.display = 'block';
                } else {
                q13j2.style.display = 'none';
                }
            });

            //stores the user input in the variables q13"*"2Value
            const q13a2Input = document.getElementById('q13a2-input');
            q13a2Input.addEventListener('input', function () {
                q13a2Value = q13a2Input.value;
                console.log(q13a2Value);
            });
            
            const q13b2Input = document.getElementById('q13b2-input');
            q13b2Input.addEventListener('input', function () {
                q13b2Value = q13b2Input.value;
                console.log(q13b2Value);
            });

            const q13c2Input = document.getElementById('q13c2-input');
            q13c2Input.addEventListener('input', function () {
                q13c2Value = q13c2Input.value;
                console.log(q13c2Value);
            }
            );

            const q13d2Input = document.getElementById('q13d2-input');
            q13d2Input.addEventListener('input', function () {
                q13d2Value = q13d2Input.value;
                console.log(q13d2Value);
            }
            );

            const q13e2Input = document.getElementById('q13e2-input');
            q13e2Input.addEventListener('input', function () {
                q13e2Value = q13e2Input.value;
                console.log(q13e2Value);
            }
            );

            const q13f2Input = document.getElementById('q13f2-input');
            q13f2Input.addEventListener('input', function () {
                q13f2Value = q13f2Input.value;
                console.log(q13f2Value);
            }
            );

            const q13g2Input = document.getElementById('q13g2-input');
            q13g2Input.addEventListener('input', function () {
                q13g2Value = q13g2Input.value;
                console.log(q13g2Value);
            }
            );

            const q13h2Input = document.getElementById('q13h2-input');
            q13h2Input.addEventListener('input', function () {
                q13h2Value = q13h2Input.value;
                console.log(q13h2Value);
            }
            );

            const q13i2Input = document.getElementById('q13i2-input');
            q13i2Input.addEventListener('input', function () {
                q13i2Value = q13i2Input.value;
                console.log(q13i2Value);
            }
            );

            const q13j2Input = document.getElementById('q13j2-input');
            q13j2Input.addEventListener('input', function () {
                q13j2Value = q13j2Input.value;
                console.log(q13j2Value);
            }
            );

            }); //end of DOMContentLoaded

            // prints the user inputs to a json file and allows the user to download it 
            function printUserInputs() {
            //stores the user input in the variables
            var q1 = document.getElementById('q1').value || "nan";
            var q2 = document.getElementById('q2').value;
            var q2other = document.getElementById('q2other-input').value;
            var q3 = document.getElementById('q3').value;
            var q4 = document.getElementById('q4').value;
            var q4other = document.getElementById('q4other-input').value;
            var q5 = document.getElementById('q5').value;
            var q5other = document.getElementById('q5other-input').value;
            var q6 = document.getElementById('q6').value; 
            var q6other = document.getElementById('q6other-input').value;
            var q7 = document.getElementById('q7').value;
            var q7other = document.getElementById('q7other-input').value;
            var q8 = document.getElementById('q8').value;
            var q8other = document.getElementById('q8other-input').value;
            var q9 = document.getElementById('q9').value;
            var q9other = document.getElementById('q9other-input').value;
            
            var q10a = document.getElementById('q10a').checked ? 'Electric car charged by electricity' : 'nan'; //if checked, then the value is the text, else it is nan
            var q10b = document.getElementById('q10b').checked ? 'Fire place powered by natural gas' : 'nan';
            var q10c = document.getElementById('q10c').checked ? 'Swimming pool, sauna, etc.' : 'nan';
            var q10d = document.getElementById('q10d').checked ? 'No uncommon devices' : 'nan';
            var q10e = document.getElementById('q10e').value || "nan";
            
            var q10 = [q10a, q10b, q10c, q10d, q10e].join(', '); //joins the values of the checked boxes and the value of the text box

            var q11 = document.getElementById('q11').value;
            var q12 = document.getElementById('q12').value;

            var q13a1 = document.getElementById('q13a1').checked ? 'My home was air-leak was tested and now it is leak-proof' : 'nan';  //stores the value of text right after the ? character if the checkbox was checked, if it wasnt checked then it stores nan
            var q13b1 = document.getElementById('q13b1').checked ? 'I replaced my windows with energy efficient windows (e.g. double or tripple-layer)' : 'nan';
            var q13c1 = document.getElementById('q13c1').checked ? 'I installed a high efficiency furnace' : 'nan';
            var q13d1 = document.getElementById('q13d1').checked ? 'I increased the thermal insulation of my building envelop (e.g. increase R-value, foam spray under roof, etc.)r' : 'nan';
            var q13e1 = document.getElementById('q13e1').checked ? 'I installed a photovoltaic system' : 'nan';
            var q13f1 = document.getElementById('q13f1').checked ? 'I installed a heat pump for home heating' : 'nan';
            var q13g1 = document.getElementById('q13g1').checked ? 'I installed a solar thermal collector' : 'nan';
            var q13h1 = document.getElementById('q13h1').checked ? 'I installed a thermal energy storage system' : 'nan';
            var q13i1 = document.getElementById('q13i1').checked ? 'I have installed a green roof' : 'nan';
            var q13j1 = document.getElementById('q13j1').checked ? 'I have installed other systems not described above' : 'nan';
            var q13 = [q13a1, q13a2Value, q13b1, q13b2Value, q13c1, q13c2Value, q13d1, q13d2Value, q13e1, q13e2Value, q13f1, q13f2Value, q13g1, q13g2Value, q13h1, q13h2Value, q13i1, q13i2Value, q13j1, q13j2Value].join(', ');
            
            q14a1 = document.getElementById('q14a1').value || "nan"; q14a2 = document.getElementById('q14a2').value || "nan"; q14a3 = document.getElementById('q14a3').value || "nan"; q14a4 = document.getElementById('q14a4').value || "nan"; q14a5 = document.getElementById('q14a5').value || "nan"; q14a6 = document.getElementById('q14a6').value || "nan"; q14a7 = document.getElementById('q14a7').value || "nan";
            q14b1 = document.getElementById('q14b1').value || "nan"; q14b2 = document.getElementById('q14b2').value || "nan"; q14b3 = document.getElementById('q14b3').value || "nan"; q14b4 = document.getElementById('q14b4').value || "nan"; q14b5 = document.getElementById('q14b5').value || "nan"; q14b6 = document.getElementById('q14b6').value || "nan"; q14b7 = document.getElementById('q14b7').value || "nan";
            q14c1 = document.getElementById('q14c1').value || "nan"; q14c2 = document.getElementById('q14c2').value || "nan"; q14c3 = document.getElementById('q14c3').value || "nan"; q14c4 = document.getElementById('q14c4').value || "nan"; q14c5 = document.getElementById('q14c5').value || "nan"; q14c6 = document.getElementById('q14c6').value || "nan"; q14c7 = document.getElementById('q14c7').value || "nan";
            q14d1 = document.getElementById('q14d1').value || "nan"; q14d2 = document.getElementById('q14d2').value || "nan"; q14d3 = document.getElementById('q14d3').value || "nan"; q14d4 = document.getElementById('q14d4').value || "nan"; q14d5 = document.getElementById('q14d5').value || "nan"; q14d6 = document.getElementById('q14d6').value || "nan"; q14d7 = document.getElementById('q14d7').value || "nan";
            q14e1 = document.getElementById('q14e1').value || "nan"; q14e2 = document.getElementById('q14e2').value || "nan"; q14e3 = document.getElementById('q14e3').value || "nan"; q14e4 = document.getElementById('q14e4').value || "nan"; q14e5 = document.getElementById('q14e5').value || "nan"; q14e6 = document.getElementById('q14e6').value || "nan"; q14e7 = document.getElementById('q14e7').value || "nan";
            q14f1 = document.getElementById('q14f1').value || "nan"; q14f2 = document.getElementById('q14f2').value || "nan"; q14f3 = document.getElementById('q14f3').value || "nan"; q14f4 = document.getElementById('q14f4').value || "nan"; q14f5 = document.getElementById('q14f5').value || "nan"; q14f6 = document.getElementById('q14f6').value || "nan"; q14f7 = document.getElementById('q14f7').value || "nan";
            q14g1 = document.getElementById('q14g1').value || "nan"; q14g2 = document.getElementById('q14g2').value || "nan"; q14g3 = document.getElementById('q14g3').value || "nan"; q14g4 = document.getElementById('q14g4').value || "nan"; q14g5 = document.getElementById('q14g5').value || "nan"; q14g6 = document.getElementById('q14g6').value || "nan"; q14g7 = document.getElementById('q14g7').value || "nan";
            q14h1 = document.getElementById('q14h1').value || "nan"; q14h2 = document.getElementById('q14h2').value || "nan"; q14h3 = document.getElementById('q14h3').value || "nan"; q14h4 = document.getElementById('q14h4').value || "nan"; q14h5 = document.getElementById('q14h5').value || "nan"; q14h6 = document.getElementById('q14h6').value || "nan"; q14h7 = document.getElementById('q14h7').value || "nan";
            q14i1 = document.getElementById('q14i1').value || "nan"; q14i2 = document.getElementById('q14i2').value || "nan"; q14i3 = document.getElementById('q14i3').value || "nan"; q14i4 = document.getElementById('q14i4').value || "nan"; q14i5 = document.getElementById('q14i5').value || "nan"; q14i6 = document.getElementById('q14i6').value || "nan"; q14i7 = document.getElementById('q14i7').value || "nan";
            q14j1 = document.getElementById('q14j1').value || "nan"; q14j2 = document.getElementById('q14j2').value || "nan"; q14j3 = document.getElementById('q14j3').value || "nan"; q14j4 = document.getElementById('q14j4').value || "nan"; q14j5 = document.getElementById('q14j5').value || "nan"; q14j6 = document.getElementById('q14j6').value || "nan"; q14j7 = document.getElementById('q14j7').value || "nan";
            q14k1 = document.getElementById('q14k1').value || "nan"; q14k2 = document.getElementById('q14k2').value || "nan"; q14k3 = document.getElementById('q14k3').value || "nan"; q14k4 = document.getElementById('q14k4').value || "nan"; q14k5 = document.getElementById('q14k5').value || "nan"; q14k6 = document.getElementById('q14k6').value || "nan"; q14k7 = document.getElementById('q14k7').value || "nan";
            q14l1 = document.getElementById('q14l1').value || "nan"; q14l2 = document.getElementById('q14l2').value || "nan"; q14l3 = document.getElementById('q14l3').value || "nan"; q14l4 = document.getElementById('q14l4').value || "nan"; q14l5 = document.getElementById('q14l5').value || "nan"; q14l6 = document.getElementById('q14l6').value || "nan"; q14l7 = document.getElementById('q14l7').value || "nan";
            
            var q14 = [ //store all the values in an array 
                q14a1, q14a2, q14a3, q14a4, q14a5, q14a6, q14a7,
                q14b1, q14b2, q14b3, q14b4, q14b5, q14b6, q14b7,
                q14c1, q14c2, q14c3, q14c4, q14c5, q14c6, q14c7,
                q14d1, q14d2, q14d3, q14d4, q14d5, q14d6, q14d7,
                q14e1, q14e2, q14e3, q14e4, q14e5, q14e6, q14e7,
                q14f1, q14f2, q14f3, q14f4, q14f5, q14f6, q14f7,
                q14g1, q14g2, q14g3, q14g4, q14g5, q14g6, q14g7,
                q14h1, q14h2, q14h3, q14h4, q14h5, q14h6, q14h7,
                q14i1, q14i2, q14i3, q14i4, q14i5, q14i6, q14i7,
                q14j1, q14j2, q14j3, q14j4, q14j5, q14j6, q14j7,
                q14k1, q14k2, q14k3, q14k4, q14k5, q14k6, q14k7,
                q14l1, q14l2, q14l3, q14l4, q14l5, q14l6, q14l7
            ].join(', ');

            var q15a1 = document.getElementById('q15a1').value || "nan"; var q15a2 = document.getElementById('q15a2').value || "nan"; var q15a3 = document.getElementById('q15a3').value || "nan"; var q15a4 = document.getElementById('q15a4').value || "nan"; var q15a5 = document.getElementById('q15a5').value || "nan"; var q15a6 = document.getElementById('q15a6').value || "nan"; var q15a7 = document.getElementById('q15a7').value || "nan";
            var q15b1 = document.getElementById('q15b1').value || "nan"; var q15b2 = document.getElementById('q15b2').value || "nan"; var q15b3 = document.getElementById('q15b3').value || "nan"; var q15b4 = document.getElementById('q15b4').value || "nan"; var q15b5 = document.getElementById('q15b5').value || "nan"; var q15b6 = document.getElementById('q15b6').value || "nan"; var q15b7 = document.getElementById('q15b7').value || "nan";
            var q15c1 = document.getElementById('q15c1').value || "nan"; var q15c2 = document.getElementById('q15c2').value || "nan"; var q15c3 = document.getElementById('q15c3').value || "nan"; var q15c4 = document.getElementById('q15c4').value || "nan"; var q15c5 = document.getElementById('q15c5').value || "nan"; var q15c6 = document.getElementById('q15c6').value || "nan"; var q15c7 = document.getElementById('q15c7').value || "nan";
            var q15d1 = document.getElementById('q15d1').value || "nan"; var q15d2 = document.getElementById('q15d2').value || "nan"; var q15d3 = document.getElementById('q15d3').value || "nan"; var q15d4 = document.getElementById('q15d4').value || "nan"; var q15d5 = document.getElementById('q15d5').value || "nan"; var q15d6 = document.getElementById('q15d6').value || "nan"; var q15d7 = document.getElementById('q15d7').value || "nan";
            var q15e1 = document.getElementById('q15e1').value || "nan"; var q15e2 = document.getElementById('q15e2').value || "nan"; var q15e3 = document.getElementById('q15e3').value || "nan"; var q15e4 = document.getElementById('q15e4').value || "nan"; var q15e5 = document.getElementById('q15e5').value || "nan"; var q15e6 = document.getElementById('q15e6').value || "nan"; var q15e7 = document.getElementById('q15e7').value || "nan";
            var q15f1 = document.getElementById('q15f1').value || "nan"; var q15f2 = document.getElementById('q15f2').value || "nan"; var q15f3 = document.getElementById('q15f3').value || "nan"; var q15f4 = document.getElementById('q15f4').value || "nan"; var q15f5 = document.getElementById('q15f5').value || "nan"; var q15f6 = document.getElementById('q15f6').value || "nan"; var q15f7 = document.getElementById('q15f7').value || "nan";
            var q15g1 = document.getElementById('q15g1').value || "nan"; var q15g2 = document.getElementById('q15g2').value || "nan"; var q15g3 = document.getElementById('q15g3').value || "nan"; var q15g4 = document.getElementById('q15g4').value || "nan"; var q15g5 = document.getElementById('q15g5').value || "nan"; var q15g6 = document.getElementById('q15g6').value || "nan"; var q15g7 = document.getElementById('q15g7').value || "nan";
            var q15h1 = document.getElementById('q15h1').value || "nan"; var q15h2 = document.getElementById('q15h2').value || "nan"; var q15h3 = document.getElementById('q15h3').value || "nan"; var q15h4 = document.getElementById('q15h4').value || "nan"; var q15h5 = document.getElementById('q15h5').value || "nan"; var q15h6 = document.getElementById('q15h6').value || "nan"; var q15h7 = document.getElementById('q15h7').value || "nan";
            var q15i1 = document.getElementById('q15i1').value || "nan"; var q15i2 = document.getElementById('q15i2').value || "nan"; var q15i3 = document.getElementById('q15i3').value || "nan"; var q15i4 = document.getElementById('q15i4').value || "nan"; var q15i5 = document.getElementById('q15i5').value || "nan"; var q15i6 = document.getElementById('q15i6').value || "nan"; var q15i7 = document.getElementById('q15i7').value || "nan";
            var q15j1 = document.getElementById('q15j1').value || "nan"; var q15j2 = document.getElementById('q15j2').value || "nan"; var q15j3 = document.getElementById('q15j3').value || "nan"; var q15j4 = document.getElementById('q15j4').value || "nan"; var q15j5 = document.getElementById('q15j5').value || "nan"; var q15j6 = document.getElementById('q15j6').value || "nan"; var q15j7 = document.getElementById('q15j7').value || "nan";
            var q15k1 = document.getElementById('q15k1').value || "nan"; var q15k2 = document.getElementById('q15k2').value || "nan"; var q15k3 = document.getElementById('q15k3').value || "nan"; var q15k4 = document.getElementById('q15k4').value || "nan"; var q15k5 = document.getElementById('q15k5').value || "nan"; var q15k6 = document.getElementById('q15k6').value || "nan"; var q15k7 = document.getElementById('q15k7').value || "nan";
            var q15l1 = document.getElementById('q15l1').value || "nan"; var q15l2 = document.getElementById('q15l2').value || "nan"; var q15l3 = document.getElementById('q15l3').value || "nan"; var q15l4 = document.getElementById('q15l4').value || "nan"; var q15l5 = document.getElementById('q15l5').value || "nan"; var q15l6 = document.getElementById('q15l6').value || "nan"; var q15l7 = document.getElementById('q15l7').value || "nan";
            
            var q15 = [ //stores all the variables in the array
                q15a1, q15a2, q15a3, q15a4, q15a5, q15a6, q15a7,
                q15b1, q15b2, q15b3, q15b4, q15b5, q15b6, q15b7,
                q15c1, q15c2, q15c3, q15c4, q15c5, q15c6, q15c7,
                q15d1, q15d2, q15d3, q15d4, q15d5, q15d6, q15d7,
                q15e1, q15e2, q15e3, q15e4, q15e5, q15e6, q15e7,
                q15f1, q15f2, q15f3, q15f4, q15f5, q15f6, q15f7,
                q15g1, q15g2, q15g3, q15g4, q15g5, q15g6, q15g7,
                q15h1, q15h2, q15h3, q15h4, q15h5, q15h6, q15h7,
                q15i1, q15i2, q15i3, q15i4, q15i5, q15i6, q15i7,
                q15j1, q15j2, q15j3, q15j4, q15j5, q15j6, q15j7,
                q15k1, q15k2, q15k3, q15k4, q15k5, q15k6, q15k7,
                q15l1, q15l2, q15l3, q15l4, q15l5, q15l6, q15l7
            ].join(', ');

            var q16 = document.getElementById('q16').value || "nan";



            function logOtherInputHandling(questionId, questionValue, otherInputValue) { //function to handle other inputs replace the value of the dropdown selection value other with the text input
                
                console.log(`Before if statement: ${questionId} =`, questionValue, `\n${questionId}other =`, otherInputValue);
                if (questionValue === 'other' && otherInputValue !== '') {
                questionValue = otherInputValue;
                }
                console.log(`After if statement: ${questionId} =`, questionValue);

                return questionValue;
            }
            
            q2 = logOtherInputHandling('q2', q2, q2other);
            q4 = logOtherInputHandling('q4', q4, q4other);
            q5 = logOtherInputHandling('q5', q5, q5other);
            q6 = logOtherInputHandling('q6', q6, q6other);
            q7 = logOtherInputHandling('q7', q7, q7other);
            q8 = logOtherInputHandling('q8', q8, q8other);
            q9 = logOtherInputHandling('q9', q9, q9other);



            // console.log("Before if statement: q2 =", q2, "\nq2other =", q2other);
            //   if (q2 == 'other') {
            //     q2 = q2other;
            //   }
            // console.log("After if statement: q2 =", q2);
            
            var formData = {
                q1: q1,
                q2: q2,
                q3: q3,
                q4: q4,
                q5: q5,
                q6: q6,
                q7: q7,
                q8: q8,
                q9: q9,
                q10: q10,
                

                q11: q11,
                q12: q12,
                q13: q13,
                q14: q14,
                q15: q15,
                q16: q16,
            
            };

            alert(JSON.stringify(formData, null, 2));
                console.log(formData);
            
                // Convert formData to JSON string
                var jsonData = JSON.stringify(formData, null, 1);
            
                // Create a Blob with the JSON data and specify the MIME type as 'application/json'
                var blob = new Blob([jsonData], { type: 'application/json' });
            
                // Create an anchor element to add the download attribute
                var downloadLink = document.createElement('a');
                downloadLink.download = 'formData.json'; // Set the file name
                downloadLink.href = URL.createObjectURL(blob); // Create a URL for the Blob
                downloadLink.style.display = 'none'; // Hide the link element
            
                // Add the download link to the DOM, click it, and remove it afterward
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
            }

            function handleOtherOption(selectId, otherInputId) {
            var selectElement = document.getElementById(selectId);
            var otherInputElement = document.getElementById(otherInputId).parentNode;

            selectElement.addEventListener("change", function () {
                if (selectElement.value == "other") {
                otherInputElement.style.display = "flex";
                document.getElementById(otherInputId).setAttribute("name", otherInputId);
                } else {
                otherInputElement.style.display = "none";
                document.getElementById(otherInputId).removeAttribute("name");
                }
            });
            }

            document.addEventListener("DOMContentLoaded", function () {
            q13a2Value = "nan";
            if (document.getElementById('q13a1').checked == true){
                q13a2Value = document.getElementById('q13a2Value').value;
            }
            q13b2Value = "nan";
            if (document.getElementById('q13b1').checked == true){
                q13b2Value = document.getElementById('q13b2Value').value;
            }
            q13c2Value = "nan";
            if (document.getElementById('q13c1').checked == true){
                q13c2Value = document.getElementById('q13c2Value').value;
            }
            q13d2Value = "nan";
            if (document.getElementById('q13d1').checked == true){
                q13d2Value = document.getElementById('q13d2Value').value;
            }
            q13e2Value = "nan";
            if (document.getElementById('q13e1').checked == true){
                q13e2Value = document.getElementById('q13e2Value').value;
            }
            q13f2Value = "nan";
            if (document.getElementById('q13f1').checked == true){
                q13f2Value = document.getElementById('q13f2Value').value;
            }
            q13g2Value = "nan";
            if (document.getElementById('q13g1').checked == true){
                q13g2Value = document.getElementById('q13g2Value').value;
            }
            q13h2Value = "nan";
            if (document.getElementById('q13h1').checked == true){
                q13h2Value = document.getElementById('q13h2Value').value;
            }
            q13i2Value = "nan";
            if (document.getElementById('q13i1').checked == true){
                q13i2Value = document.getElementById('q13i2Value').value;
            }
            q13j2Value = "nan";
            if (document.getElementById('q13j1').checked == true){
                q13j2Value = document.getElementById('q13j2Value').value;
            }
            
            handleOtherOption("q2", "q2other-input");
            handleOtherOption("q4", "q4other-input");
            handleOtherOption("q5", "q5other-input");
            handleOtherOption("q6", "q6other-input");
            handleOtherOption("q7", "q7other-input");
            handleOtherOption("q8", "q8other-input");
            handleOtherOption("q9", "q9other-input");
            });

            // Get all the div elements in the survey.html file
            const divs = document.querySelectorAll('div');

            // Check if the number of divs is even or odd
            if (divs.length % 2 === 0) {
            console.log('There is an even number of divs in the survey.html file.');
            } else {
            console.log('There is an odd number of divs in the survey.html file.');
}


      </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.8/xlsx.full.min.js"></script>
</body>
</html>
